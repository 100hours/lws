LiveReader.DocumentsRoute = Ember.Route.extend
  model: ->
    this.store.findAll('document')
  activate: ->
    # Setup Pusher
    pusher = new Pusher('8146487894a3cc81758c')
    @set('pusher', pusher)

    channel = pusher.subscribe('<%= Rails.env %>_main_channel')

    channel.bind 'patch', (payload) =>
      payload.updated_at = new Date(payload.updated_at)
      doc = @model().find((item) => item.get('id') == payload.id)
